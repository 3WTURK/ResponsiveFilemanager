!function(e){"use strict";var t=function(t,n){this.$elements=e(t);this.options=n;this.before=this.options.before||this.before;this.onItem=this.options.onItem||this.onItem;if(this.options.target)this.$elements.attr("data-target",this.options.target);this.listen()};t.prototype={constructor:t,show:function(t){var n=e(this),r,i,s;if(n.is(".disabled, :disabled"))return;s=e.Event("context");if(!this.before.call(this,t,e(t.currentTarget)))return;this.$elements.trigger(s);r=this.getMenu();var o=this.getPosition(t,r);r.attr("style","").css(o).data("_context_this_ref",this).addClass("open");return false},closemenu:function(e){this.getMenu().removeClass("open")},before:function(e){return true},onItem:function(e,t){return true},listen:function(){var t=this;this.$elements.on("contextmenu.context.data-api",e.proxy(this.show,this));e("html").on("click.context.data-api",e.proxy(this.closemenu,this));var n=e(this.$elements.attr("data-target"));n.on("click.context.data-api",function(n){if(e(this).data("_context_this_ref")==t){t.onItem.call(this,n,e(n.target))}});e("html").on("click.context.data-api",function(e){if(!e.ctrlKey){n.removeClass("open")}})},destroy:function(){this.$elements.off(".context.data-api").removeData("context");e("html").off(".context.data-api");var t=e(this.$elements.attr("data-target"));t.off(".context.data-api")},getMenu:function(){var t=this.$elements.attr("data-target"),n;if(!t){t=this.$elements.attr("href");t=t&&t.replace(/.*(?=#[^\s]*$)/,"")}n=e(t);return n},getPosition:function(t,n){var r=t.clientX,i=t.clientY,s=e(window).width(),o=e(window).height(),u=n.find(".dropdown-menu").outerWidth(),a=n.find(".dropdown-menu").outerHeight(),f={position:"fixed"},l,c;if(i+a>o){l={top:i-a}}else{l={top:i}}if(r+u>s&&r-u>0){c={left:r-u}}else{c={left:r}}return e.extend(f,l,c)},clearMenus:function(t){if(!t.ctrlKey){e("[data-toggle=context]").each(function(){this.getMenu().removeClass("open")})}}};e.fn.contextmenu=function(e,n){var r=this;return function(){var i=r.data("context"),s=typeof e=="object"&&e;if(!i)r.data("context",i=new t(r,s));if(typeof e=="string")i[e].call(i,n)}()};e.fn.contextmenu.Constructor=t;e(document).on("contextmenu.context.data-api","[data-toggle=context]",function(t){e(this).contextmenu("show",t);t.preventDefault()})}(window.jQuery)